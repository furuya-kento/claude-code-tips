# Claude Code Tips

このドキュメントは、Claude Codeを効果的に使用するためのtipsとベストプラクティスをまとめたものです。

## 目次
1. [初期セットアップ](#初期セットアップ)
2. [知識管理システム](#知識管理システム)
3. [プロンプト戦略](#プロンプト戦略)
4. [思考モード](#思考モード)
5. [ワークフロー](#ワークフロー)
6. [コマンドリファレンス](#コマンドリファレンス)
7. [デバッグとトラブルシューティング](#デバッグとトラブルシューティング)
8. [生産性向上のヒント](#生産性向上のヒント)

## 初期セットアップ

### インストール
```bash
npm install -g @anthropic-ai/claude-code
```

### セッション開始
```bash
# 通常のセッション開始
claude

# 権限チェックをスキップしてセッション開始
claude --dangerously-skip-permissions
```

**`--dangerously-skip-permissions`オプションについて:**
- **目的**: ファイル権限チェックを無効化して高速起動
- **使用場面**: 信頼できる環境でのみ使用
- **注意点**: 
  - セキュリティリスクが増加します
  - 本番環境では使用しないでください
  - 個人開発や学習用途に限定して使用してください
  - 重要なファイルが誤って変更される可能性があります

### プロジェクトの初期化
1. まず、プロジェクトの概要を理解させる
   ```
   > このプロジェクトの概要を説明してください
   ```

2. `CLAUDE.md`ファイルを作成
   ```
   > /init
   ```

## 知識管理システム

### `.claude/`ディレクトリ構造
プロジェクトのルートに`.claude/`ディレクトリを作成し、以下のファイルを配置することで、セッション間で知識を永続化できます：

```
.claude/
├── CLAUDE.md              # メインのプロジェクト設定
├── context.md             # プロジェクトの背景と制約
├── project-knowledge.md   # 技術的な洞察
├── project-improvements.md # 改善ログ
├── common-patterns.md     # よく使うコマンドパターン
└── debug-log.md          # デバッグログ
```

### 各ファイルの役割

#### CLAUDE.md
- プロジェクト固有の設定とガイダンス
- ビルドコマンド、テストコマンドなど
- コーディング規約やスタイルガイド
- [サンプルファイル](examples/CLAUDE.md)

#### context.md
- プロジェクトの背景情報
- ビジネス要件
- 技術的制約
- [サンプルファイル](examples/context.md)

#### project-knowledge.md
- プロジェクト固有の技術的知識
- 依存関係の詳細
- アーキテクチャの決定事項
- [サンプルファイル](examples/project-knowledge.md)

#### project-improvements.md
- 実施した改善の記録
- 学んだ教訓
- 今後の改善案
- [サンプルファイル](examples/project-improvements.md)

#### common-patterns.md
- よく使うコマンドの組み合わせ
- 頻出する問題の解決パターン
- カスタムスニペット
- [サンプルファイル](examples/common-patterns.md)

#### debug-log.md
- 30分以上かかった問題の記録
- 再発する可能性のある問題
- チーム全体で共有すべき知識
- [サンプルファイル](examples/debug-log.md)

## プロンプト戦略

### 効果的なプロンプトの原則
1. **明確なコンテキストを提供**
   - 現在の状況を説明
   - 期待する結果を明確に

2. **具体的な成果物を指定**
   - 「〜を作成してください」
   - 「〜を修正してください」

3. **過去のプロジェクト知識を活用**
   - `.claude/`内のファイルを参照
   - 以前の解決策を思い出させる

### 大量のテキスト入力を避ける
プロンプトに大量のテキストを直接入力する代わりに、ファイルに記述してから参照させる：

```
# 悪い例
> 以下の長い仕様書に基づいて実装してください: [1000行のテキスト]

# 良い例
> specs.mdファイルを読んで、その仕様に基づいて実装してください
```

## 思考モード

Claude Codeには異なる深さの思考モードがあります：

### 基本的な思考モード
- `think` - 4,000トークンの制限
- `think hard` - 10,000トークンの制限
- `think harder` - 31,999トークンの制限
- `ultrathink` - 31,999トークンの制限（最も深い分析）

### 使用例
複雑な問題や設計決定が必要な場合：
```
> ultrathink: このアーキテクチャの長所と短所を分析してください
```

## ワークフロー

### 推奨される開発フロー
1. **Explore（探索）**
   - プロジェクト構造を理解
   - 既存のコードを調査

2. **Plan（計画）**
   - タスクを小さなステップに分解
   - 実装方針を決定

3. **Code（コーディング）**
   - 段階的に実装
   - 各ステップで動作確認

4. **Commit（コミット）**
   - 意味のある単位でコミット
   - 明確なコミットメッセージ

### テスト駆動開発（TDD）
1. テストを先に書く
2. テストが失敗することを確認
3. 最小限のコードで実装
4. リファクタリング

## コマンドリファレンス

### 基本コマンド
- `/init` - プロジェクトコンテキストを再初期化
- `/clear` - 会話コンテキストをリセット
- `/help` - ヘルプを表示

### セッション管理
- `claude --resume` - 前回のセッションを復元
- `npx ccusage` - 使用状況を確認

### `/init`コマンドの使用タイミング
- プロジェクトの初回セットアップ時
- 知識ファイルを更新した時
- 新しいチームメンバーが参加した時
- 定期的なメンテナンス時

## デバッグとトラブルシューティング

### デバッグログの活用
以下の場合は`debug-log.md`に記録：
- 解決に30分以上かかった問題
- 再発する可能性がある問題
- チーム全体で共有すべき知識

### 記録フォーマット例
```markdown
## [日付] 問題のタイトル

### 症状
- エラーメッセージ
- 発生条件

### 原因
- 根本原因の説明

### 解決方法
- 実施した手順
- 使用したコマンド

### 予防策
- 今後の対策
```

## 生産性向上のヒント

### 通知設定
タスク完了時に通知を受け取る：
```bash
claude config set --global preferredNotifChannel terminal_bell
```

### コンテキスト管理
1. **定期的な知識ファイルの更新**
   - 週次または月次でレビュー
   - 不要な情報を整理

2. **チーム間での知識共有**
   - `.claude/`ディレクトリをバージョン管理
   - 重要な発見を共有

3. **継続的な改善**
   - 作業効率の測定
   - ボトルネックの特定と改善

### パフォーマンス最適化
1. **明確で簡潔なプロンプト**
   - 不要な説明を避ける
   - 具体的な指示を与える

2. **適切な思考モードの選択**
   - 単純なタスクには基本モード
   - 複雑な分析にはultrathink

3. **ファイルベースの入力**
   - 大量のテキストはファイルに
   - 構造化されたデータの活用

## 追加の実践的なTips

### コード生成の最適化
1. **既存コードスタイルの踏襲**
   - プロジェクトのコーディング規約を事前に伝える
   - サンプルコードを提供して期待するスタイルを明確に

2. **段階的な実装アプローチ**
   - 大きな機能は小さなステップに分割
   - 各ステップで動作確認を依頼

3. **エラーハンドリングの明示**
   - エラーケースを具体的に指定
   - ログ出力の形式を統一

### セキュリティのベストプラクティス
1. **機密情報の取り扱い**
   - APIキーや認証情報はファイルに記載しない
   - 環境変数の使用を推奨

2. **入力検証の徹底**
   - ユーザー入力の検証ロジックを明示的に要求
   - SQLインジェクション対策の確認

### パフォーマンスの考慮事項
1. **効率的なデータ処理**
   - 大量データ処理時の最適化を依頼
   - 非同期処理の活用

2. **キャッシング戦略**
   - 適切なキャッシング実装を提案
   - キャッシュ無効化のタイミング

### チーム開発での活用
1. **コードレビューの準備**
   - 実装意図をコメントで明確化
   - テストケースの充実

2. **ドキュメンテーション**
   - API仕様書の自動生成
   - 使用例の提供

### トラブルシューティングのコツ
1. **エラーメッセージの活用**
   - 完全なエラーメッセージを提供
   - 発生条件を明確に

2. **デバッグ情報の収集**
   - ログファイルの関連部分を抽出
   - 再現手順を詳細に

### 高度な使用方法
1. **マルチファイル編集**
   - 関連ファイルをまとめて指定
   - 依存関係を明示

2. **リファクタリング支援**
   - 改善ポイントの分析を依頼
   - 段階的なリファクタリング計画

3. **テスト戦略**
   - ユニットテストとE2Eテストの使い分け
   - モックの効果的な活用

## ベストプラクティスのまとめ

1. **システマティックなアプローチ**
   - 知識管理システムの構築
   - 一貫したワークフローの維持

2. **継続的な学習と改善**
   - デバッグログの活用
   - チーム知識の共有

3. **効率的なコミュニケーション**
   - 明確なプロンプト
   - 適切なコンテキスト提供

4. **ツールの最大活用**
   - 各種コマンドの理解
   - 思考モードの使い分け

5. **品質重視の開発**
   - セキュリティの考慮
   - パフォーマンスの最適化

これらのtipsを活用することで、Claude Codeでの開発効率、チームコラボレーション、コード品質を大幅に向上させることができます。定期的にこのドキュメントを見直し、新しい発見や改善点を追加していくことをお勧めします。